# 이미지 크기

이미지 크기가 클 경우 렌더링 속도가 느려질텐데 이를 개선하기 위해 어떤 방법을 적용할 수 있을까?

## 이미지 최적화

- 이미지 최적화는 실제로 우리가 서버에서 데이터를 받아올 때 불필요한 요청을 여러번 하지 않아도 되며, 서버의 저장 공간이 적게 필요로 한다.
- 이는 비용 절감으로도 이어지며, 유저가 서비스에 접근했을 경우 더 빠르고 쾌적한 웹 환경을 제공한다.

그렇다면, 최적화를 하지 않으면 어떤 일이 일어날까?

- 이미지 로딩이 늦어지기 때문에 웹화면이 그려지는데 오랜 시간이 소요됨
- 서버에 저장공간을 많이 잡아먹기 때문에 서버 비용이 올라감
- 불필요한 요청을 계속해서 받아와 그려내야 함
- 웹 페이지 바이트가 커지며 버벅거릴 수 있음

## 이미지 최적화 방법

### width값 조정

- width값을 줄여주는 것만으로도 이미지의 용량을 줄일 수 있다.

### 이미지 포맷 설정

- 이미지의 종류에 맞게 포맷을 설정하면 이미지 최적화를 할 수 있다.
  - JPG : 카메라로 찍은 실제 사진 (핸드폰 카메라로 찍은 사진 등)
  - PNG : 만들어진 이미지 (일러스트 혹은 패드 등으로 그린 그림 등)

### 이미지 고정값

- 치수가 없는 이미지들은 Reflow를 발생시켜 퍼포먼스를 저하시킨다.
- 이 때문에 이미지 및 비디오 요소에 width, height 속성을 포함시키면 이미지가 로드되는 동안 브라우저가 문서의 공간을 올바르게 할당할 수 있다.
- 반응형 웹 디자인의 경우 보통 이를 생략하고 css를 사용하여 이미지 크기를 조정하는데, 이 접근 방식의 단점은 다운로드가 시작되고 브라우저가 크기를 결정할 수 있는 경우에만 이미지를 위한 공간을 할당할 수 있다는 점

### 여러 버전의 이미지 제공

- 3~5개의 서로 다른 크기의 이미지를 제공하고 더 많은 이미지 크기를 제공하면 성능 향상은 되지만 그만큼 서버에서 더 많은 공간을 차지하고 HTML을 조금 더 작성해야한다.

#### src 속성

브라우저가 srcset , sizes 속성을 지원하지 않으면 src 속성이 동작 (모든 디바이스 크기에서 동작할 수 있을만큼 충분히 커야함)

#### srcset 속성

이미지 파일명과 width, density 설명을 쉼표로 구분

```html
<img
  src="flower-large.jpg"
  srcset="flower-small.jpg 480w, flower-large.jpg 1080w"
  sizes="50vw"
/>
```

### Image CDNs

- 이미지 최적화에 탁월하고, 이를 이용해 전환하면 파일 크기를 40%~80% 줄일 수 있다.
- 이미지 변환, 최적화 및 전송을 전문으로 하고, 사이트에서 사용되는 이미지에 대한 접근이나 조작을 위한 API로 생각할 수 있음.

### CSS sprite

웹페이지에 필수적으로 자주 사용되는 아이콘, 버튼 같은 이미지들을 쓸 때마다 여러 이미지들을 불러오는 것이 아니라, 한 이미지 파일로 통합한 후 배경 이미지를 만들어놓고 position 값으로 각각의 이미지를 불러오는 것 방법

```css
div#sprite {
  background: url(/images/sprite.png) no-repeat;
} //한 이미지를 불러옴

// position으로 각 이미지를 불러옴
div#sprite > .first {
  background-position: 0 0;
}
div#sprite > .second {
  background-position: 0 -15px;
}
div#sprite > .third {
  background-position: 0 -30px;
}
```

### Lazy loading

- 페이지를 로드할 때, 모든 이미지를 로드하는 것이 아니라 중요하지 않은 자원 또는 당장 필요 없는 자원의 경우 서버에 요청을 미루고 필요한 경우 해당 자원을 요청 받는 방법
- 데이터의 낭비를 막을 수 있고, 브라우저는 서버로부터 자원을 요청받고 난 뒤에 화면을 랜더링하기 때문에 불필요한 자원의 다운로드를 막는 것만으로도 프로세스 시간이 단축될 수 있다 (브라우저의 랜더링 시간을 줄여줌)

---

### 참고

- https://velog.io/@resyve/d7uz4czw
