## 브라우저의 렌더링 과정에 대해 설명해주세요
사용자가 브라우저의 주소창에 `URL`을 입력하면 `HTML` 파일을 받게 되는데까지 추가적인 과정이 존재하지만, 여기서는 브라우저의 렌더링에만 집중해서 말씀드리겠습니다.  

![웹킷 동작 과정](https://d2.naver.com/content/images/2015/06/helloworld-59361-3.png)

1. **`HTML` 문서 해석**  
`HTML` 문서는 단순히 마크업 형태로 되어있는 텍스트 데이터이기 때문에 브라우저가 읽을 수 있는 형태로 변환해야 합니다. 따라서 브라우저는 `HTML` 문서를 위에서부터 차근차근 해석하면서 문법적 의미를 가진 최소 단위인 토큰으로 파싱합니다.
2. **DOM 트리 구성**  
토큰의 내용에 따라서 문서 노드, 요소 노드, 어트리뷰트 노드, 텍스트 노드를 생성합니다. 그리고 이런 노드의 부모 자식 관계를 반영하여 트리 형태의 자료구조를 만듭니다. 이것이 바로 `DOM 트리` 입니다.
3. **리소스 가져오기**  
`link`, `img`, `script` 등 외부의 리소스를 가져오는 태그를 만나면 진행하고 있던 `HTML` 파싱을 잠시 중단하고 네트워크 요청을 합니다.
4. **CSSOM 트리 구성**  
`CSS` 파일을 가져오는 `link` 태그를 만나면 `HTML 파싱` 과 마찬가지로 `CSS` 문서를 해석하고 트리 형태의 구조를 만듭니다. 이것이 `CSSOM: (CSS Object Model) 트리` 입니다.  
5. **Render Tree 구성**  
`DOM 트리` 와 `CSSOM 트리` 를 결합하여 `Render Tree` 를 만듭니다. 이렇게 완성된 렌더 트리는 이후 `Layout` 과정과 `Paint` 과정에서 사용됩니다.
6. **Layout**  
`HTML` 요소를 화면에 정확하게 어느 위치에 배치 할 것인지를 계산합니다. 이 과정에서 `%` 나 `em` 같은 상대적인 단위가 `px` 로 변환됩니다.
7. **Paint**  
레이아웃 과정에서 계산된 내용을 참고하여 화면에 실제 픽셀로 그려집니다.

### Reflow, Repaint
자바스크립트 동작, 이벤트 동작, 브라우저의 크기 변화 등으로 인해서 화면의 요소에 변화가 발생하면 `DOM` 이나 `CSSOM` 가 변경됩니다.  

이 경우 `Render Tree` 를 재구성하고 상황에 따라서 `Layout` 이나 `Paint` 과정을 반복하게 되는데 이 과정을 `Reflow` 혹은 `Repaint` 라고 합니다.

> **Reflow**: Layout 과정의 재발생  
> **Repaint**: Paint 과정의 재발생

특히 리플로우 과정은 상대적으로 비용이 많이 드는 과정이기에 같은 기능을 구현한다고 할 때 가능하다면 리플로우를 발생시키는 동작 대신 리페인트를 발생하는 방향으로 구현하는 것이 좋습니다.

### async, defer
![async와 defer](https://uploads.disquscdn.com/images/4303414a00e244a653fc9a4894719b730caae6d4c647b97966b1061ae16fec48.png?w=800&h=461)

기본적으로 `HTML` 문서에서 `script` 태그를 만나면 렌더링 엔진은 렌더링을 일시 중단하고 자바스크립트 엔진에게 제어권을 위임합니다.  

만약 자바스크립트를 해석하고 처리하는데 오랜 시간이 걸린다면 사용자가 온전한 화면을 보기까지 오래 걸리게 됩니다.  

그렇기 때문에 `script` 태그에 `async` 나 `defer` 속성을 주거나 혹은 `script` 태그를 `body` 의 최하단 부분으로 작성하는 것이 좋습니다.  

> **기본 script**: JS 파일을 받고 자바스크립트를 실행하는 동안에는 렌더링이 중단됩니다.  
> **script async**: JS 파일을 받는 동안은 렌더링이 계속 유지되고, 자바스크립트를 실행하는 동안에는 렌더링이 중단됩니다.  
> **script defer**: JS 파일을 받는 동안은 렌더링이 계속 유지되고, 자바스크립트의 실행은 화면이 온전히 그려진 이후로 지연됩니다.  

## 참고 자료
모던 자바스크립트 Deep Dive 38장 브라우저 렌더링  
[브라우저 렌더링 과정 이해하기 (Tecoble)](https://tecoble.techcourse.co.kr/post/2021-10-24-browser-rendering/)  
[브라우저는 어떻게 동작하는가? (Naver D2)](https://d2.naver.com/helloworld/59361)  
[defer, async 스크립트 (코어 자바스크립트)](https://ko.javascript.info/script-async-defer)  
